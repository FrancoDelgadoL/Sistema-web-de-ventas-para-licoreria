@{
    ViewData["Title"] = "Panel de Administración";
}
<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>@ViewData["Title"]</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <!-- Estilos personalizados -->
    <link href="~/css/Admin/Index.css" rel="stylesheet">
</head>

<body>
    <!-- Contenedor principal -->
    <div class="container-fluid">
        <div class="row">
            <!-- Sidebar -->
            <div class="sidebar shadow-sm col-md-3 col-lg-2 p-0">
                <div class="logo text-center p-3">
                    <h3 class="mb-1 fw-bold">
                        <i class="bi bi-shop me-2 text-primary"></i>EZEL <span class="text-primary">Market</span>
                    </h3>
                    <small class="text-light opacity-75">Panel de Administración</small>
                </div>

                <nav class="nav flex-column mt-4 px-3">
                    <a class="nav-link @(ViewContext.RouteData.Values["action"]?.ToString() == "Index" ? "active" : "")"
                       href="/Admin/Index">
                        <i class="bi bi-house-door me-2"></i>Inicio
                    </a>
                    <a class="nav-link @(ViewContext.RouteData.Values["action"]?.ToString() == "ListarUsuarios" ? "active" : "")"
                       href="/Admin/ListarUsuarios">
                        <i class="bi bi-people me-2"></i>Usuarios
                    </a>
                    <a class="nav-link @(ViewContext.RouteData.Values["action"]?.ToString() == "AsignarRoles" ? "active" : "")"
                       href="/Admin/AsignarRoles">
                        <i class="bi bi-person-gear me-2"></i>Asignar Roles
                    </a>
                    <a class="nav-link active" href="/Admin/ListarCupones"><i class="bi bi-ticket-perforated me-2"></i>Cupones</a>
                    <a class="nav-link @(ViewContext.RouteData.Values["action"]?.ToString() == "Perfil" ? "active" : "")"
                       href="/Admin/Perfil">
                        <i class="bi bi-person me-2"></i>Perfil
                    </a>
                    <a class="nav-link"
                       href="/Inventario/Index">
                        <i class="bi bi-box me-2"></i>Gestión de Inventario
                    </a>

                    <button type="button" class="nav-link text-danger w-100 text-start bg-transparent border-0 mt-2"
                            data-bs-toggle="modal" data-bs-target="#logoutModal">
                        <i class="bi bi-box-arrow-right me-2"></i>Cerrar Sesión
                    </button>
                </nav>

                <div class="user-info mt-auto text-center p-3 border-top border-secondary-subtle">
                    @if (User.Identity.IsAuthenticated && ViewBag.NombreUsuario != null)
                    {
                        <p class="mb-1 fw-semibold text-light">@ViewBag.NombreUsuario</p>
                        <small class="text-light opacity-75">Administrador</small>
                        <br>
                        <small class="text-light opacity-75">Último acceso: @DateTime.Now.ToString("dd/MM/yyyy")</small>
                    }
                    else
                    {
                        <p class="mb-1 fw-semibold text-light">Invitado</p>
                    }
                </div>
            </div>

            <!-- Contenido principal -->
            <div class="content flex-grow-1 col-md-9 col-lg-10 p-0">
                <header class="content-header d-flex justify-content-between align-items-center p-3 shadow-sm bg-white">
                    <h4 class="mb-0"><i class="bi bi-speedometer2 me-2 text-primary"></i> Dashboard</h4>
                    <span class="text-muted small">Sistema de ventas para licorería</span>
                </header>

                <main class="p-4">
                    <!-- Mensaje de bienvenida -->
                    <div class="text-center mb-4">
                        
                        
                        <!-- DEBUG TEMPORAL -->
                        @if (ViewBag.DebugInfo != null)
                        {
                            <div class="alert alert-warning">
                                <strong>Debug:</strong> @ViewBag.DebugInfo
                            </div>
                        }
                    
                        @if (User.Identity.IsAuthenticated)
                        {
                            <div class="alert alert-success mt-4">
                                @if (ViewBag.NombreUsuario != null)
                                {
                                    <h3>Bienvenido, @ViewBag.NombreUsuario!</h3>

                                }
                                else
                                {
                                    <h3>¡Hola, @User.Identity.Name!</h3>
                                    <p>Has iniciado sesión correctamente.</p>
                                    <small class="text-muted">(Información completa no disponible)</small>
                                }
                            </div>
                        }
                        else
                        {
                            <p>Por favor inicia sesión.</p>
                        }
                    </div>

                    <div class="row g-3">
                        <div class="col-md-4">
                            <div class="card shadow-sm border-0 rounded-4">
                                <div class="card-body text-center">
                                    <i class="bi bi-people fs-1 text-primary"></i>
                                    <h5 class="mt-3">Usuarios Registrados</h5>
                                    <p class="text-muted mb-0">Gestiona todos los usuarios del sistema.</p>
                                </div>
                            </div>
                        </div>

                        <div class="col-md-4">
                            <div class="card shadow-sm border-0 rounded-4">
                                <div class="card-body text-center">
                                    <i class="bi bi-shield-lock fs-1 text-success"></i>
                                    <h5 class="mt-3">Roles y Permisos</h5>
                                    <p class="text-muted mb-0">Asigna o modifica los roles de usuario.</p>
                                </div>
                            </div>
                        </div>

                        <div class="col-md-4">
                            <div class="card shadow-sm border-0 rounded-4">
                                <div class="card-body text-center">
                                    <i class="bi bi-box2-heart fs-1 text-warning"></i>
                                    <h5 class="mt-3">Inventario y Ventas</h5>
                                    <p class="text-muted mb-0">Consulta el estado general del sistema.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </main>
            </div>
        </div>
    </div>

    <!-- Modal de cierre de sesión -->
    <div class="modal fade" id="logoutModal" tabindex="-1" aria-labelledby="logoutModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content border-0 shadow">
                <div class="modal-header bg-danger text-white">
                    <h5 class="modal-title" id="logoutModalLabel">
                        <i class="bi bi-box-arrow-right me-2"></i>Confirmar cierre de sesión
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    ¿Estás seguro de que deseas cerrar sesión?
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <form asp-controller="Cuenta" asp-action="Logout" method="post">
                        <button type="submit" class="btn btn-danger">Cerrar sesión</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>